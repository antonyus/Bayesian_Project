---
title: "Project 2: Birth Year"
author:
  - Sofiya Antonyuk
  - Edoardo Pennesi
  - Dorothy Chepkoech
  - Andreea Badache
  - Steve Omollo
date: "`r Sys.Date()`"
output:
  html_document: default
  pdf_document: default
  word_document: default
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  warning = FALSE,
  message = FALSE
)

# Libraries
library(ggplot2)
library(plotly)
```

#2.2 Project 2: Birth year
The next table summarizes, based on a survey, the number of children that
had at least one dose of the Varicella vaccine. It gives the number of vac-
cinated children (Vaccinated) among the number of children in the survey
(Sample Size). The information is provided for 3 regions of the US, and split
according to birth cohort (2011-2020)

```{r}

# Import datasets
vacc_data <- read.csv("vaccination_data.csv")

# Preview
head(vacc_data)

```

#1 
Derive analytically the posterior of the vaccination coverage per birth
year and region. Use a conjugate prior that (1) reflects no knowledge
on the vaccination coverage, and (2) reflects that vaccination coverage
is typically around 90% or higher. Give posterior summary measures
of the vaccination coverage per birth year and region. Is the choice of
the prior impacting your results?

```{r}


```

#2
Investigate whether there is a change in the vaccination coverage over
the birth years 2011-2019 using a logistic regression model
Yij ∼ Binom(πij , Nij )
with
logit(πij ) = β0 + β1 ∗ BirthY earj ,
where i is the location, j is birth cohort and πij is the vaccination cover-
age. Assume non-informative priors for the parameters to be estimated.
Write and explain the code in BUGS language

```{r}


```

#3
Run the MCMC method and check convergence of the MCMC chains.
Give the details on how you checked convergence

```{r}


```

#4
Make a plot of the posterior densities and give summary measures of the
posterior distributions of the model parameters. Interpret the results.

```{r}


```

#5
Give the posterior estimate of the vaccination coverage per birth year.
Compare with the analytical results you obtained in Question 1.

```{r}


```

#6
Secondly, investigate whether the vaccination coverage trends are dis-
tinct at the different locations by adding a location-specific intercept
and slope:
logit(πij ) = β0i + β1i ∗ BirthYearj

Use data from the years 2011-2019. Assume non-informative priors for
the parameters to be estimated. Write the code in BUGS language.
Give a brief summary of the convergence checks you performed. Give
the posterior estimates of this model.

```{r}


```

#7
What is the probability (a posteriori) that there is an increase in vac-
cination coverage (per location)?

```{r}


```

#8
Make a plot of the estimated vaccination coverage (per location and
birth year), including the uncertainty on the estimates. Include also
the observed vaccination proportion in the plot.

```{r}


```

#9
Investigate whether the observed number of vaccinated children in 2020
is in line with the expectations from earlier years. For this, compare
the observed number of vaccinated children in 2020 with the prediction
intervals for number of vaccinated children in 2020.
```{r}


```


#10
Make pairwise comparisons of the vaccination coverage in 2019 by es-
timating the ratio of the vaccination coverage in 2019 in two locations.
Interpret the results.
7
```{r}


```
